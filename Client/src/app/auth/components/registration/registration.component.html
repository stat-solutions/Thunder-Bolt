<div
  class="container-fluid d-flex flex-row justify-content-center mb-0 mt-md-1 mt-1 pt-md-0 pt-0 pb-0 shadow-lg col-xs-12 col-lg-8"
>
  <div class="jumbotron-fluid mb-0 pb-0">
    <div class="head-icon d-flex justify-content-center mt-3 mb-3 pb-0">
      <img
        class="mx-auto mb-0 pb-0"
        src="assets/img/mafuta-logo-2b.svg"
        width="35"
        height="35"
      />
  </div>
  <div class="card-body mt-1 pt-2 mb-0 pb-3 shadow-lg">
    <h3 class="text-info d-flex justify-content-center mt-2 pt-1 mb-3">
      Register
    </h3>
    <form [formGroup]="userForm" (ngSubmit)="register()">
      <div class="form-group text-primary">
        <label
          for="full_name"
          [ngClass]="fval.full_name.valid ? 'text-info' : ''"
          >Full Name<i *ngIf="fval.full_name.valid" class="material-icons"
            >check_circle</i
          ></label
        >
        <div class="input-group mb-0">
          <div class="input-group-prepend">
            <div class="input-group-text">
              <i class="fas fa-user text-primary mx-auto" style="size: 50px;">
              </i>
            </div>
          </div>
          <input
            id="full_name"
            formControlName="full_name"
            type="text"
            class="form-control"
            [ngClass]="{
              'is-invalid':
                (fval.full_name.touched || fval.full_name.dirty) &&
                fval.full_name.errors
            }"
            placeholder="Enter Name"
            autocomplete="off"
          />
        </div>
        <div
          class="text-danger col"
          *ngIf="
            (fval.full_name.touched || fval.full_name.dirty) &&
            fval.full_name.errors?.required
          "
        >
          The full name is required!
        </div>
      </div>

      <div class="form-group text-primary">
        <label
          for="date_of_birth"
          [ngClass]="fval.date_of_birth.valid ? 'text-info' : ''"
          >Date Of Birth<i *ngIf="fval.date_of_birth.valid" class="material-icons"
            >check_circle</i
          ></label
        >

        <div class="input-group mb-0">
          <div class="input-group-prepend">
            <div class="input-group-text">
              <i
                class="fas fa-calendar-alt text-primary mx-auto"
                style="size: 50px;"
              >
              </i>
            </div>
          </div>
          <input
            id="date_of_birth"
            formControlName="date_of_birth"
            type="text"
            class="form-control"
            [ngClass]="{
              'is-invalid':
                (fval.date_of_birth.touched || fval.date_of_birth.dirty) &&
                fval.date_of_birth.errors
            }"
            placeholder="Click to select Date Of Birth"
            autocomplete="off"
            class="form-control"
            bsDatepicker
            [bsConfig]="{ dateInputFormat: 'MM/DD/YYYY', isAnimated: true }"
            placement="bottom"
          />
        </div>
        <div
          class="text-danger col"
          *ngIf="
            (fval.date_of_birth.touched || fval.date_of_birth.dirty) &&
            fval.date_of_birth.errors?.required
          "
        >
          The date of birth is required!
        </div>
      </div>
      <div class="form-group text-primary">
        <label
          for="id_type"
          [ngClass]="fval.id_type.valid ? 'text-info' : ''"
          >ID Type<i *ngIf="fval.id_type.valid" class="material-icons"
            >check_circle</i
          ></label
        >
        <div class="input-group mb-0">
          <div class="input-group-prepend">
            <div class="input-group-text">
              <i class="fas fa-user-tag text-primary mx-auto" style="size: 50px;">
              </i>
            </div>
          </div>
          <select
          formControlName="id_type"
          class="form-control"
          [ngClass]="{
            'is-invalid':
              (fval.id_type.touched || fval.id_type.dirty) &&
              fval.id_type.errors
          }"
          autocomplete="off"
          placeholder="Select the ID type"
          (change)='setSelectedChanges(fval.id_type.value)'
        >
          <option>NATIONAL ID</option>
          <option>PASSPORT</option>
          <option>DRIVING PERMIT</option>
          <option>VILLAGE ID</option>
        </select>
    </div>
        <div
          class="text-danger col"
          *ngIf="
            (fval.id_type.touched || fval.id_type.dirty) &&
            fval.id_type.errors?.required
          "
        >
          The ID type is required!
        </div>
      </div>
      <div class="form-group text-primary">
        <label
          for="id_number"
          [ngClass]="fval.id_number.valid ? 'text-info' : ''"
          >ID Number<i
            *ngIf="fval.id_number.valid"
            class="material-icons"
            >check_circle</i
          ></label
        >
        <div class="input-group mb-0">
          <div class="input-group-prepend">
            <div class="input-group-text">
              <i
                class="fas fa-id-card text-primary mx-auto"
                style="size: 50px"
              ></i>
            </div>
          </div>
          <input
            id="id_number"
            formControlName="id_number"
            type="text"
            class="form-control"
            [ngClass]="{
              'is-invalid':
                (fval.id_number.touched || fval.id_number.dirty) &&
                fval.id_number.errors
            }"
            placeholder="Enter your ID number"
            autocomplete="off"
          />
        </div>
        <div
          class="text-danger col"
          *ngIf="
            (fval.id_number.touched || fval.id_number.dirty) &&
            fval.id_number.errors?.required
          "
        >
          The ID number is required!
        </div>
        <!--div
          class="text-danger col"
          *ngIf="
            (fval.id_number.touched || fval.id_number.dirty) &&
            fval.id_number.errors?.minLength && fval.id_type.value === 'National ID'
          "
        >
          Please enter valid National ID number!
        </div-->
      </div>
<div class="form-group text-primary">
        <label for="email" [ngClass]="fval.email.valid ? 'text-info' : ''"
          >Email<i *ngIf="fval.email.valid" class="material-icons"
            >check_circle</i
          ></label>
        <div class="input-group mb-0">
          <div class="input-group-prepend">
            <div class="input-group-text">
              <i
                class="fas fa-envelope text-primary mx-auto"
                style="size: 50px;"
              ></i>
            </div>
          </div>
          <input
            id="email"
            formControlName="email"
            type="text"
            class="form-control"
            [ngClass]="{
              'is-invalid':
                (fval.email.touched || fval.email.dirty) && fval.email.errors
            }"
            placeholder="Email address (Optional)"
            autocomplete="off"
          />
        </div>
        <div
          class="text-danger col"
          *ngIf="
            (fval.email.touched ||
            fval.email.dirty) &&
          fval.email.errors?.pattern
          "
        >
          Please enter valid email address!
        </div>
      </div>
    <div class="form-group text-primary">
        <label
          for="user_contact_number"
          [ngClass]="fval.user_contact_number.valid ? 'text-info' : ''"
          >Phone Number<i
            *ngIf="fval.user_contact_number.valid"
            class="material-icons"
            >check_circle</i
          ></label
        >
        <div class="input-group mb-0">
          <div class="input-group-prepend">
            <div class="input-group-text">
              <i
                class="fas fa-phone text-primary mx-auto"
                style="size: 50px;"
              ></i>
            </div>
          </div>
          <input
            id="user_contact_number"
            formControlName="user_contact_number"
            type="text"
            class="form-control"
            [ngClass]="{
              'is-invalid':
                (fval.user_contact_number.touched ||
                  fval.user_contact_number.dirty) &&
                fval.user_contact_number.errors
            }"
            placeholder="e.g. 07XXXXXXXX"
            autocomplete="off"
          />
        </div>
        <div
          class="text-danger col"
          *ngIf="
            (fval.user_contact_number.touched ||
              fval.user_contact_number.dirty) &&
            fval.user_contact_number.errors?.required
          "
        >
          The phone number is required!
        </div>
        <div
          class="text-danger col"
          *ngIf="
            (fval.user_contact_number.touched ||
              fval.user_contact_number.dirty) &&
            fval.user_contact_number.errors?.hasNumber
          "
        >
          The phone number should be equal to 10 "digits"!
        </div>
      </div>
      <div class="form-group text-primary">
        <label
          for="position"
          [ngClass]="fval.position.valid ? 'text-info' : ''"
          >Position<i *ngIf="fval.position.valid" class="material-icons"
            >check_circle</i
          ></label
        >
        <div class="input-group mb-2">
          <div class="input-group-prepend">
            <div class="input-group-text">
              <i class="fas fa-user-cog text-primary mx-auto" style="size: 50px;">
              </i>
            </div>
          </div>
          <select
          formControlName="position"
          class="form-control"
          [ngClass]="{
            'is-invalid':
              (fval.position.touched || fval.position.dirty) &&
              fval.position.errors
          }"
          autocomplete="off"
          placeholder="Select the Position"
          [(ngModel)] = positionValue
        >
          <option></option>
          <option *ngFor="let role of roles; let i = index">{{role.roleName}}</option>
        </select>
    </div>
        <div
          class="text-danger col"
          *ngIf="
            (fval.position.touched || fval.position.dirty) &&
            fval.position.errors?.required
          "
        >
          The position is required!
        </div>
      </div>
        <!--the divs below will appear depending on the position selected-->
        <div class="form-group text-primary" *ngIf="(positionValue === 'CENTRAL USER')">
          <label
            for="central"
            [ngClass]="fval.central.valid ? 'text-info' : ''"
            >Choose Unit<i *ngIf="fval.central.valid" class="material-icons"
              >check_circle</i
            ></label
          >
          <div class="input-group mb-0">
            <select
            formControlName="central"
            class="form-control"
            [ngClass]="{
              'is-invalid':
                (fval.central.touched || fval.central.dirty) &&
                fval.central.errors
            }"
            autocomplete="off"
            placeholder="Select Unit"
            (change)="log()"
            >
            <option></option>
            <option   *ngFor="let unit of units">
              {{unit.bussinessUnitName}}
            </option>
          </select>
      </div>
          <div
            class="text-danger col"
            *ngIf="
              (fval.central.touched || fval.central.dirty) &&
              fval.central.errors?.required
            "
          >
            The unit is required!
          </div>
        </div>
        <div class="form-group text-primary" *ngIf="(positionValue === 'AREA USER')">
          <label
            for="area"
            [ngClass]="fval.area.valid ? 'text-info' : ''"
            >Choose Region<i *ngIf="fval.area.valid" class="material-icons"
              >check_circle</i
            ></label
          >
          <div class="input-group mb-0">
            <select
            formControlName="area"
            class="form-control"
            [ngClass]="{
              'is-invalid':
                (fval.area.touched || fval.area.dirty) &&
                fval.area.errors
            }"
            autocomplete="off"
            placeholder="Select Region"

          > <option></option>
            <option  *ngFor="let area of areas">
              {{area.areaRegionName.toUpperCase()}}
            </option>
          </select>
      </div>
          <div
            class="text-danger col"
            *ngIf="
              (fval.area.touched || fval.area.dirty) &&
              fval.area.errors?.required
            "
          >
            The region is required!
          </div>
        </div>
        <!--the div for town-->
        <div class="form-group text-primary" *ngIf="(positionValue === 'TOWN USER')">
          <label
            for="town"
            [ngClass]="fval.town.valid ? 'text-info' : ''"
            >Choose Town<i *ngIf="fval.town.valid" class="material-icons"
              >check_circle</i
            ></label
          >
          <div class="input-group mb-0">
            <select
            formControlName="town"
            class="form-control"
            [ngClass]="{
              'is-invalid':
                (fval.town.touched || fval.town.dirty) &&
                fval.town.errors
            }"
            autocomplete="off"
            placeholder="Select town"
          ><option></option>
            <option *ngFor="let town of towns">
              {{town.townName.toUpperCase()}}
            </option>
          </select>
      </div>
          <div
            class="text-danger col"
            *ngIf="
              (fval.town.touched || fval.town.dirty) &&
              fval.town.errors?.required
            "
          >
            The town is required!
          </div>
        </div>

        <!--the div for station-->
        <div class="form-group text-primary" *ngIf="(positionValue  === 'STATION USER')">
          <label
            for="station"
            [ngClass]="fval.station.valid ? 'text-info' : ''"
            >Choose station<i *ngIf="fval.station.valid" class="material-icons"
              >check_circle</i
            ></label
          >
          <div class="input-group mb-2">
            <select
            formControlName="station"
            class="form-control"
            [ngClass]="{
              'is-invalid':
                (fval.station.touched || fval.station.dirty) &&
                fval.station.errors
            }"
            autocomplete="off"
            placeholder="Select station"
            >
            <option></option>
            <option   *ngFor="let station of stations">
              {{station.stationName.toUpperCase()}}
            </option>
          </select>
          </div>
          <div
            class="text-danger col"
            *ngIf="
              (fval.station.touched || fval.station.dirty) &&
              fval.station.errors?.required
            "
          >
            The station is required!
          </div>
        </div>
        <div class="form-group text-primary">
          <label
            for="password"
            [ngClass]="fval.password.valid ? 'text-info' : ''"
            >Create PIN<i *ngIf="fval.password.valid" class="material-icons"
              >check_circle</i
            ></label
          >

          <div class="input-group mb-0">
            <div class="input-group-prepend">
              <div class="input-group-text">
                <i
                  class="fas fa-lock text-primary mx-auto"
                  style="size: 50px"
                ></i>
              </div>
            </div>
            <input
              id="password"
              formControlName="password"
              [type]="fieldType ? 'text' : 'password'"
              class="form-control"
              [ngClass]="{
                'is-invalid':
                  (fval.password.touched || fval.password.dirty) &&
                  fval.password.errors
              }"
              placeholder="Enter your PIN"
              autocomplete="off"
            />
            <div class="input-group-append">
              <span class="input-group-text">
                <i
                  class="fas"
                  [ngClass]="{
                    'fa-eye-slash': !fieldType,
                    'fa-eye': fieldType
                  }"
                  (click)="toggleFieldType()"
                ></i>
              </span>
            </div>
          </div>
          <div
            class="text-danger col"
            *ngIf="
              (fval.password.touched || fval.password.dirty) &&
              fval.password.errors?.required
            "
          >
          Your PIN is required!
          </div>

          <div
            class="col"
            *ngIf="
              (fval.password.touched || fval.password.dirty) &&
              fval.password.invalid
            "
            [ngClass]="
              fval.password.errors?.required ||
              fval.password.errors?.minlength ||
              fval.password.errors?.maxlength
                ? 'text-danger'
                : 'text-info'
            "
          >
            <i class="material-icons">{{
              fval.password.errors?.required ||
              fval.password.errors?.minlength ||
              fval.password.errors?.maxlength
                ? "cancel"
                : "check_circle"
            }}</i>
            PIN should have exactly four digits!
          </div>
          <div
            class="col"
            *ngIf="
              (fval.password.touched || fval.password.dirty) &&
              fval.password.invalid
            "
            [ngClass]="
              fval.password.hasError('required') ||
              fval.password.hasError('hasNumber')
                ? 'text-danger'
                : 'text-info'
            "
          >
            <i class="material-icons">{{
              fval.password.hasError("required") ||
              fval.password.hasError("hasNumber")
                ? "cancel"
                : "check_circle"
            }}</i>
            Only digits are allowed!
          </div>
        </div>
        <div class="form-group text-primary">
          <label
            for="confirmPassword"
            [ngClass]="fval.confirmPassword.valid ? 'text-info' : ''"
            >Confirm PIN<i
              *ngIf="fval.confirmPassword.valid"
              class="material-icons"
              >check_circle</i
            ></label
          >

          <div class="input-group mb-0">
            <div class="input-group-prepend">
              <div class="input-group-text">
                <i
                  class="fas fa-lock text-primary mx-auto"
                  style="size: 50px"
                ></i>
              </div>
            </div>
            <input
              id="confirmPassword"
              formControlName="confirmPassword"
              [type]="fieldType ? 'text' : 'password'"
              class="form-control"
              [ngClass]="{
                'is-invalid':
                  (fval.confirmPassword.touched ||
                    fval.confirmPassword.dirty) &&
                  fval.confirmPassword.errors
              }"
              placeholder="Confirm your PIN"
              autocomplete="off"
            />
            <div class="input-group-append">
              <span class="input-group-text">
                <i
                  class="fas"
                  [ngClass]="{
                    'fa-eye-slash': !fieldType,
                    'fa-eye': fieldType
                  }"
                  (click)="toggleFieldType()"
                ></i>
              </span>
            </div>
          </div>

          <div
            class="text-danger col"
            *ngIf="fval.confirmPassword.errors?.NoPasswordMatch"
          >
            PINs do not match!
          </div>
          <div
            class="text-danger col"
            *ngIf="
              fval.confirmPassword.errors?.required &&
              (fval.confirmPassword.touched || fval.confirmPassword.dirty)
            "
          >
            Please confirm your PIN!
          </div>
        </div>
      <div class="d-flex my-2 py-2 mx-auto">
        <button
          type="submit"
          class="btn btn-info col-5 mx-auto"
          [disabled]="!userForm.valid"
        >
          Register
        </button>

        <button
          type="button"
          class="btn btn-info col-5 mx-auto"
          (click)="returnHome()"
          routerLink = "/authpage/login"
        >
          Cancel
        </button>
        <ngx-spinner class="bg-info" size="medium" type="ball-scale-multiple">
          <p class="text-light">Please wait...</p>
        </ngx-spinner>

        <label class="col" *ngIf="errored" class="text-danger">
          <i class="material-icons">Cancel</i>

          <ngx-alerts></ngx-alerts>
        </label>

        <label class="col" *ngIf="posted" class="text-info">
          <i class="material-icons">check_circle</i>
          <ngx-alerts></ngx-alerts>
        </label>
    </div>
    </form>
    <!-- </div>  -->
    <!-- </div>   -->
  </div>
</div>
</div>
<!--footer -->
  <div
    class="d-flex justify-content-center col-xs-12 col-lg-12 mt-3 mb-2 mx-auto"
  >
    <div class="small text-center text-primo">
     &copy; 2020 - ThunderBolt
    </div>
</div>

